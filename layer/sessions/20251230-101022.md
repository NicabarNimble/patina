# Session: spec-llm-frontends.md
**ID**: 20251230-101022
**Started**: 2025-12-30T15:10:22Z
**LLM**: claude
**Git Branch**: patina
**Session Tag**: session-20251230-101022-start
**Starting Commit**: c9b145e3656c8d7323fa260a658806fb1158094e

## Previous Session Context
Last session (resent) was exploratory research: analyzed build.md status, updated spec-architectural-alignment (removed ~130 lines stale content), reworked spec-three-layers from narrative to grounded reality (what exists vs what we want), and created spec-llm-frontends.md documenting Claude Code, Gemini CLI, and Codex capabilities. Key findings: all three frontends support MCP as universal abstraction, but Codex uses AGENTS.md (not CODEX.md) and lacks custom commands - fixed the AGENTS.md bug in launch.rs/adapter.rs/internal.rs. Open items: Codex templates don't exist yet, session tracking pattern doesn't transfer to Codex.

## Goals
- [ ] spec-llm-frontends.md research and discovery
- [ ] Continue research on LLM frontend capabilities
- [ ] Define minimal surface for patina/frontend integration

## Activity Log
### 10:10 - Session Start
Session initialized with goal: spec-llm-frontends.md
Working on branch: patina
Tagged as: session-20251230-101022-start


### 11:14 - Update (covering since 10:10)

**Git Activity:**
- Commits this session:        0
- Files changed: 8
- Last commit: 5 hours ago

**Work Completed:**
- Deep research into Codex, Gemini CLI, and OpenCode capabilities via source code
- Added all three as patina reference repos (`patina repo add`)
- Discovered OpenCode supports Claude Pro/Max subscriptions via OAuth
- Confirmed Gemini CLI HAS hooks (previously marked as no hooks - was wrong)
- Major spec-llm-frontends.md update with new two-layer architecture

**Key Decisions:**
1. **Two-layer architecture**: Interactive Layer (Claude Code, OpenCode, Gemini CLI) + Delegate Layer (Codex)
2. **Codex moves to delegate role**: No custom commands/hooks = can't do session tracking, but valuable for A/B testing and second opinions
3. **OpenCode is strategic**: Works with Claude subscription AND cheap API models - multi-provider escape hatch
4. **Subscription-first focus**: All interactive frontends must work with flat-rate subscriptions

**Discussion Context:**
- Started with "Codex doesn't fit patina's session model" observation
- User reframed: Codex as delegate agent spawned FROM interactive sessions
- This preserves session tracking (happens in interactive layer) while using Codex's batch nature as a feature

**Patterns Observed:**
- OpenCode and Gemini CLI are closer to Claude Code than expected (both have hooks, commands)
- MCP truly is universal - all four support it
- Different frontends suit different interaction models (interactive vs batch/agentic)

**Reference repos added:**
- github.com/openai/codex
- github.com/google-gemini/gemini-cli
- github.com/sst/opencode


### 11:15 - Final Update (covering since 11:14)

**Git Activity:**
- Commits this session:        0
- Files changed: 8
- Last commit: 5 hours ago

**Work Completed:**
- Session update captured
- Preparing for session end

**Session Summary:**
This was a research and discovery session focused on LLM frontend architecture. Major outcome: two-layer model (Interactive + Delegate) with subscription-first focus. OpenCode emerges as strategic option for multi-provider access while using Claude subscription.


## Session Classification
- Work Type: exploration
- Files Changed:        0
- Commits:        0
- Patterns Modified:        0
- Session Tags: session-20251230-101022-start..session-20251230-101022-end
