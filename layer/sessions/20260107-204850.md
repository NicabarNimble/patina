# Session: ref-repo-semantic
**ID**: 20260107-204850
**Started**: 2026-01-08T01:48:50Z
**LLM**: claude
**Git Branch**: patina
**Session Tag**: session-20260107-204850-start
**Starting Commit**: c5cbbe64588a753fca7c7e84729ff62c5651d822

## Previous Session Context
Last session fixed the ONNX token length error (>512 tokens) that was blocking SDL and livestore repos by implementing tokenizer truncation. All 13/13 ref repos now have semantic indexes (up from 11/13). Also fixed CI issues (Cargo.lock tracking, macOS-only log_debug) and merged PR #70. Key insight: truncation preserves semantic quality (0.85-0.92 scores) because function signatures and early logic carry the most meaning.

## Goals
- [ ] Continue eval and measurements on ref-repo semantic indexes
- [ ] Assess semantic search quality across the 13 indexed repos

## Activity Log
### 20:48 - Session Start
Session initialized with goal: ref-repo-semantic
Working on branch: patina
Tagged as: session-20260107-204850-start


### 23:24 - Update (covering since 20:48)

**Git Activity:**
- Commits this session:        0
- Files changed: 13
- Last commit: 4 hours ago

**Work Completed:**
- Reviewed eval status: 26 queries across 4 repos, 77% hit rate
- Re-ran the 6 "failed" queries manually to verify results
- Found all 6 failures were ground truth issues, not search failures (actual 100% hit rate)
- Tested edge case repos: game-engine (13% conv), SDL (23%), scryer-prolog, daydreams, USearch
- Discovered two real weaknesses in semantic search

**Discussion Context:**
- Applied Ng principle: "Don't optimize what you haven't validated"
- Questioned whether the 77% finding was actionable (answer: not really, just validates system works)
- Pivoted to edge case testing to find actual weaknesses

**Key Findings:**
1. **Ground truth was too narrow** - All 6 "failures" returned valid results, just different files than expected
2. **Tiny repos fail** - game-engine (310 vectors, 13% conv) shows lower scores (0.83-0.84) and tangential results
3. **Domain terminology gap** - "unification algorithm" query fails on scryer-prolog because code uses `unify`, not academic terminology
4. **Large repos compensate** - SDL works well (0.85-0.88 scores) despite 23% conv due to 12K vectors

**Challenges:**
- Hybrid mode doesn't help terminology gap (FTS5 needs stemming)
- Query "unify" → perfect results, but "unification algorithm" → complete miss

**Potential Fixes Identified:**
- Skip semantic for < 500 vectors (tiny repo noise)
- Add FTS5 stemming (unification → unify)
- Query expansion via LLM (larger effort)


## Session Classification
- Work Type: exploration
- Files Changed:        0
- Commits:        0
- Patterns Modified:        0
- Session Tags: session-20260107-204850-start..session-20260107-204850-end
