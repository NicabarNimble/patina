# Session: spec-init-hardening
**ID**: 20260112-210605
**Started**: 2026-01-13T02:06:05Z
**LLM**: claude
**Git Branch**: patina
**Session Tag**: session-20260112-210605-start
**Starting Commit**: f7bd55b077c27c611a2bd39d4f12e1cd431cf562

## Previous Session Context
Last session implemented Phases 1 & 2 of the spec-init-hardening spec: Phase 1 simplified `patina init` to skeleton-only creation (no --llm arg, added --no-commit flag, creates project UID), while Phase 2 added `adapter refresh` (backup/update/restore templates) and `adapter doctor` (health check adapters). The new user flow is now `patina init` → `patina adapter add claude` → `patina`. Ready for Phase 3 implementation (doctor expand, config protect).

## Goals
- [ ] spec-init-hardening

## Activity Log
### 21:06 - Session Start
Session initialized with goal: spec-init-hardening
Working on branch: patina
Tagged as: session-20260112-210605-start


### 22:44 - Update (covering since 21:06)

**Git Activity:**
- Commits this session: 4
- Files changed: 27
- Last commit: 50 seconds ago

**Work Completed:**
- Deep dive into spec-init-hardening implementation and code review
- Fixed hierarchy check bug (re-init detected itself as child conflict)
- Designed and implemented `.patina/local/` directory structure
- Created spec: `layer/surface/build/spec-patina-local.md`
- Updated 26 files with new path structure
- Fixed ENVIRONMENT.toml contradiction (gitignored but committed)
- Created migration script for old projects

**Key Decisions:**
- `.patina/local/` holds all gitignored state (databases, cache, backups)
- `.patina/config.toml`, `uid`, `oxidize.yaml` stay at root (committed)
- No migration code in core - separate one-time script instead
- Let git errors speak for themselves - no custom error handling for old gitignore

**Jon Gjengset Principles Applied:**
- Clear separation: committed config vs local state
- No migration cruft in main code
- Trust users to read error messages
- Simple shell script for one-time fixes

**Patterns Observed:**
- Migration logic accumulates complexity - better to fail fast and document fix
- Contradictions in code (gitignore + commit same file) indicate design drift


## Session Classification
- Work Type: pattern-work
- Files Changed:       28
- Commits:        4
- Patterns Modified:        1
- Session Tags: session-20260112-210605-start..session-20260112-210605-end
