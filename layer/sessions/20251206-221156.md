# Session: layer/core/build.md review
**ID**: 20251206-221156
**Started**: 2025-12-07T03:11:56Z
**LLM**: claude
**Git Branch**: patina
**Session Tag**: session-20251206-221156-start
**Starting Commit**: 246060e14e3e05eb635f31594527c264df98f016

## Previous Session Context
Last session (20251206-101304) completed Phase 4a by testing the full `patina rebuild --force` flow and verifying scry works after rebuild. Major cleanup: removed bounty detection from core (5 files, +51/-620 lines) - it's now marked as a future plugin. Also fixed pre-push script to mirror CI exactly (use `cargo fmt --check` and `clippy -D warnings`). Open items: Phase 4b (external repo oxidize) and Phase 4c (--all-repos flag for scry).

## Goals
- [ ] layer/core/build.md review

## Activity Log
### 22:11 - Session Start
Session initialized with goal: layer/core/build.md review
Working on branch: patina
Tagged as: session-20251206-221156-start


### 23:32 - Update (covering since 22:11)

**Git Activity:**
- Commits this session: 2
- Files changed: 10 (7 docs, 3 code)
- Last commit: 24 minutes ago

**Work Completed:**
- Reviewed build.md against actual code - verified Phase 4 status is accurate
- Started Phase 4b implementation: added `--oxidize` flag to `patina repo update`
- Discovered 3 key challenges with oxidizing external repos
- Had architectural discussion that clarified two-tier model

**Key Decisions:**
- **Two-tier architecture crystallized:**
  - Patina Projects (via `patina init`): full RAG, sessions, all dimensions
  - Reference Repos (via `patina repo add`): lightweight index, FTS5 + dependency only
- Owner vs Contributor is git remote config, not patina concern - both use `patina init`
- Removed `--contrib` flag concept from `repo add` (belongs on `init` if anywhere)

**Challenges Faced:**
1. Hardcoded paths in embeddings assume running from patina project dir - solved with symlink
2. External repos lack training data (no sessions → no semantic, shallow clone → no temporal)
3. Config.toml schema evolved without migration path

**Patterns Observed:**
- The "what data is available" determines "what dimensions work"
- Reference repos are fundamentally different from projects - trying to make them the same was wrong
- Architecture clarity came from discussing the use cases (owner/contributor/reference)


## Session Classification
- Work Type: pattern-work
- Files Changed:       10
- Commits:        2
- Patterns Modified:        7
- Session Tags: session-20251206-221156-start..session-20251206-221156-end
