# Session: Building the Mothership
**ID**: 20251125-144512
**Started**: 2025-11-25T19:45:12Z
**LLM**: claude
**Git Branch**: patina
**Session Tag**: session-20251125-144512-start
**Starting Commit**: f9121b535fd422a3b8f8249f7311fd2e60745875

## Previous Session Context
Completed Phase 3 hackathon MVP roadmap implementation: Added `--file` flag for temporal queries enabling direct vector lookup without re-embedding, implemented FTS5 lexical search with auto-detection for exact-match patterns ("find X", "::", "()"), and created migration pattern for existing databases. Key insight validated: different query interfaces per dimension (text→text for semantic, file→files for temporal). Made 4 focused commits with clean tests passing. Ready for remaining Phase 3 items: oxidize dependency dimension and evaluation framework expansion.

## Goals
- [ ] Building the Mothership

## Activity Log
### 14:45 - Session Start
Session initialized with goal: Building the Mothership
Working on branch: patina
Tagged as: session-20251125-144512-start


### 23:36 - Update (covering since 14:45)

**Git Activity:**
- Commits this session: 0
- Files changed: 3
- Last commit: 9 hours ago

**Work Completed:**

1. **Session Recovery**
   - Recovered from crash, reviewed session 20251125-130143 and git history
   - Identified that Phase 3a (--file flag) and 3b (FTS5 lexical) were already implemented
   - Updated build.md to mark 3a and 3b as complete

2. **Mothership Spec Design (Major)**
   - Rewrote spec-mothership-service.md with comprehensive Ollama-style architecture
   - Defined WWOD (What Would Ollama Do) pattern: lazy loading, explicit registration
   - Designed directory structure: `~/.patina/` for central mothership data
   - Created registry.yaml schema with projects + repos + indexed metadata
   - Defined CLI commands: `patina repo add/list/update/rm/show`, `patina project add/list/rm`
   - Designed daemon behavior: startup, lazy load on first query, KEEP_ALIVE eviction
   - Defined query routing logic and result merging with tags
   - Specified REST API endpoints for future daemon
   - Scoped Hackathon MVP (v0.1): repo add/list, --project flag, registry (~4 days)

3. **Naming Refinement**
   - Renamed `refs` → `repos` throughout spec for clarity

4. **Architecture Review**
   - Reviewed session 20251119-061119 (Patina Cohesion) for original architecture decisions
   - Identified tension: original design had repos in `layer/dust/repos/` (project-local)
   - Current spec has repos in `~/.patina/repos/` (central)
   - Discussion in progress on which approach to take

**Key Decisions:**

1. **Ollama-style CLI** - `patina repo add dojo --github dojoengine/dojo` mirrors `ollama pull`
2. **Daemon is optional for MVP** - Direct DB access works, daemon adds lazy loading
3. **Federated data** - Projects keep their own patina.db, mothership has pointers
4. **Three-tier projects** - Primary (yours), Contributor (team), Reference repos

**Challenges & Open Questions:**

1. **Central vs Project-Local Repos**
   - Original session 20251119 designed repos in `layer/dust/repos/` (project-local)
   - New spec has `~/.patina/repos/` (central, shared)
   - Tradeoff: portability vs deduplication
   - Needs decision: which approach aligns with hackathon goals?

2. **Existing `patina scrape code --repo` command**
   - Already works with `layer/dust/repos/`
   - Need to decide if it stays project-local or moves to central

**Patterns Observed:**

1. **Session history is gold** - Reading 20251119-061119 revealed careful architectural thinking
2. **"Librarian not library"** - Mothership tracks, doesn't duplicate (key metaphor)
3. **Lazy loading everywhere** - Clone on demand, load on query, evict on idle


## Session Classification
- Work Type: exploration
- Files Changed:        0
- Commits:        0
- Patterns Modified:        0
- Session Tags: session-20251125-144512-start..session-20251125-144512-end
