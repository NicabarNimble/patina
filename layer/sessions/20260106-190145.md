# Session: state of patina - ref repo review
**ID**: 20260106-190145
**Started**: 2026-01-07T00:01:46Z
**LLM**: claude
**Git Branch**: patina
**Session Tag**: session-20260106-190145-start
**Starting Commit**: b80730663b06d977d8ea92fe1641bb16492516a2

## Previous Session Context
Last session (20260106-130041 "mother") validated G2.5: graph routing achieved 100% repo recall vs 0% for dumb routing on cross-project queries, ran `patina mother learn` to update edge weights (1.0 → 1.02-1.06), and read 42K+ lines of session archaeology to write "Story of Patina". Major conceptual work: created `layer/surface/concept-repo-patina.md` capturing the Codex Q&A Agent design—an RL-style loop where Codex generates persona-driven questions, gathers evidence via patina tools, and proposes answers for user approval. Key insight: "We're not building retrieval. We're building preference capture."

## Goals
- [ ] state of patina - ref repo review

## Activity Log
### 19:01 - Session Start
Session initialized with goal: state of patina - ref repo review
Working on branch: patina
Tagged as: session-20260106-190145-start


### 22:03 - Update (covering since 19:01)

**Git Activity:**
- Commits this session: 0
- Files changed: 4
- Last commit: 9 hours ago

**Work Completed:**
1. **Deep dive into ref repo data extraction system**
   - Explored what data actually exists in ref repo databases (function_facts, type_vocabulary, call_graph, commits, moments, etc.)
   - Discovered critical gap: ref repos have `dependency.usearch` but NO `semantic.usearch`
   - Root cause: semantic projection trains on session observations, which ref repos don't have

2. **Reframed Patina's value proposition**
   - Key insight from user: "We're building preference capture, not retrieval"
   - Patina is the portable layer of user-specific knowledge that lives OUTSIDE any LLM
   - LLMs will have their own memory, but it's locked in (Claude doesn't talk to Gemini)
   - Patina = the layer that travels with the user

3. **Commit messages as training signal analysis**
   - Applied Andrew Ng measurement-first lens to the problem
   - Hypothesis: commit messages are (NL, code) pairs for free
   - Analyzed patina vs dojo commits in depth
   - Then ran full analysis across all 13 ref repos

4. **Created comprehensive analysis document**
   - `layer/surface/analysis-commit-training-signal.md`
   - 48,560 total commits across 13 ref repos
   - Tiered repos by training signal quality (gemini-cli = best, game-engine = skip)
   - Documented filtering strategy, moment boosting, implementation plan

**Discussion Context:**
- Started with "what can we do with ref repos?"
- Discovered semantic search returns dependency relationships only (not semantic!)
- User pushed back on ML measurement framing: "we're building preference capture"
- Shifted to "how do we get ref repo wisdom into portable patina?"
- Identified commit messages as the training signal for ref repo semantic projection

**Key Decisions:**
1. Use commit messages as anchor, touched files as positive, untouched as negative
2. Filter by conventional commit format (feat/fix/refactor) + length > 30
3. Boost by moment type (breaking=3x, big_bang=2x, migration=1.5x)
4. Tier repos: prioritize gemini-cli, dojo, opencode, codex, livestore for training

**Challenges Faced:**
- `patina assay derive-moments` crashed on unicode in commit message (bug found)
- Semantic oracle silently returns empty when no semantic.usearch exists
- Many ref repos have low conventional commit % (scryer-prolog 13%, game-engine 13%)

**Patterns Observed:**
- Commit scopes reveal architecture (dojo: katana/torii/sozo, gemini-cli: core/cli/ui/telemetry)
- Moments are universal - every repo has them, they're the highest signal commits
- LLM-generated commits (patina) are more consistent than human commits (dojo)
- Message length correlates with usefulness (avg 50+ chars = good signal)


### 22:05 - Update (covering since 22:03)

**Git Activity:**
- Commits this session: 0
- Files changed: 4
- Last commit: 9 hours ago

**Work Completed:**
- Final session update and wrap-up
- Session documentation complete

**Session Summary:**
This was a pure exploration/analysis session. No code was written, but critical gaps were identified and a comprehensive analysis document was created. The main output is `layer/surface/analysis-commit-training-signal.md` which provides the foundation for implementing commit-based semantic training for ref repos.


## Session Classification
- Work Type: exploration
- Files Changed:        0
- Commits:        0
- Patterns Modified:        0
- Session Tags: session-20260106-190145-start..session-20260106-190145-end
